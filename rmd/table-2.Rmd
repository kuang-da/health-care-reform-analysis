```{r}
hcg <-  read.table("../data/w.data")
colnames(hcg) = c("id","year", "doctco", "age", 
                  "male","educ","married","hsize", 
                  "sport", "goodh", "badh", "sozh", 
                  "loginc", "ft", "pt", "unemp", 
                  "winter", "spring", "fall")
emp_vec <- c()
for (idx in seq(dim(hcg)[1])){
  if(hcg[[idx, 'ft']] == 1)
    emp_vec <- c(emp_vec, 'full-time')
  else if (hcg[[idx, 'pt']] == 1)
    emp_vec <- c(emp_vec, 'part-time')
  else if (hcg[[idx, 'unemp']] == 1)
    emp_vec <- c(emp_vec, 'unemployed')
  else
    emp_vec <- c(emp_vec, 'self-employed')
}
```

```{r}
data_df <- hcg %>% 
  tibble() %>%
  mutate(age2=age^2) %>%
  mutate(married=factor(married)) %>%
  mutate(sport=factor(sport)) %>%
  mutate(goodh=factor(goodh)) %>%
  mutate(badh=factor(badh)) %>%
  mutate(emp=factor(emp_vec)) %>%
  mutate(year=factor(year)) %>%
  select(doctco, age, age2, male, educ, married, hsize, sport, 
         goodh, badh, emp, loginc, year)
```

```{r}
model_fit <- glm(doctco~age+age2+male+educ+married+hsize
    +sport+goodh+badh+emp+loginc+year, family = "poisson", data = data_df)

summary(model_fit)
```

